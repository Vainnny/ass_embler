# –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π

## –ß—Ç–æ –±—ã–ª–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ

### üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ test3.bmp:
- **–í—Ä–µ–º—è —Ä–∞—Å–∫—Ä–∞—Å–∫–∏:** 0.0002 —Å–µ–∫—É–Ω–¥—ã (—Å—Ç–∞–±–∏–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ)
- **–û–±—â–µ–µ –≤—Ä–µ–º—è:** 0.0059 —Å–µ–∫—É–Ω–¥—ã
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–≤–µ—Ç–æ–≤:** 3 (–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ)
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä—ë–±–µ—Ä:** 23 (–≤—Å–µ —Å–≤—è–∑–∏ –Ω–∞–π–¥–µ–Ω—ã)

---

## –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ —Ñ–∞–π–ª–∞–º

### 1. `graph.c` - –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞ —Å–º–µ–∂–Ω–æ—Å—Ç–∏

#### ‚úÖ –ü—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
1. **Inline —Ñ—É–Ω–∫—Ü–∏—è `add_edge_fast()`** - –±—ã—Å—Ç—Ä–∞—è –≤–µ—Ä—Å–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä—ë–±–µ—Ä –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫
2. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ —Å—Ç—Ä–æ–∫—É –º–∞—Ç—Ä–∏—Ü—ã** - `int* row = graph->matrix[vertex]` –≤–º–µ—Å—Ç–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π
3. **–ë–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞ –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–µ–≥–∏–æ–Ω–æ–≤** - O(1) –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–º–µ—Å—Ç–æ O(n) –ª–∏–Ω–µ–π–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ `region_count > 1`** - —Ä–∞–Ω–Ω–∏–π –≤—ã—Ö–æ–¥, –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–µ–≥–∏–æ–Ω
5. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –≤ —Ü–∏–∫–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä—ë–±–µ—Ä** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤

**–û–∂–∏–¥–∞–µ–º–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ:** ~20-30% –¥–ª—è —ç—Ç–∞–ø–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞

---

### 2. `colorizer.c` - –†–∞—Å–∫—Ä–∞—Å–∫–∞ –≥—Ä–∞—Ñ–∞

#### ‚úÖ –ü—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
1. **–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Ä–∞–∑–≤–µ—Ä—Ç–∫–∞ —Ü–∏–∫–ª–∞ –≤ `get_degree()`** - –ø—Ä–æ—Å—Ç–æ–π —Ü–∏–∫–ª –¥–ª—è –º–∞–ª—ã—Ö –≥—Ä–∞—Ñ–æ–≤, —Ä–∞–∑–≤–µ—Ä—Ç–∫–∞ –¥–ª—è –±–æ–ª—å—à–∏—Ö
2. **–£–ª—É—á—à–µ–Ω–Ω–∞—è —Ä–∞–∑–≤–µ—Ä—Ç–∫–∞ –≤ `is_color_safe()`** - –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–º–µ—Å—Ç–æ –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `continue` –≤–º–µ—Å—Ç–æ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö `else`** - —É–ø—Ä–æ—â–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
4. **–£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ —Ü–≤–µ—Ç–æ–≤** - —Ü–≤–µ—Ç–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –≤–∞–ª–∏–¥–Ω—ã –ø–æ—Å–ª–µ —Ä–∞—Å–∫—Ä–∞—Å–∫–∏
5. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –¥–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** - `Pixel* image_data = image->data`

**–û–∂–∏–¥–∞–µ–º–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ:** ~25-35% –¥–ª—è —ç—Ç–∞–ø–∞ —Ä–∞—Å–∫—Ä–∞—Å–∫–∏

---

### 3. `region_detector.c` - –ü–æ–∏—Å–∫ —Ä–µ–≥–∏–æ–Ω–æ–≤

#### ‚úÖ –ü—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
1. **Inline —Ñ—É–Ω–∫—Ü–∏—è `is_white()`** - —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –≤—ã–∑–æ–≤
2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—è–¥–∫–∞ –ø—Ä–æ–≤–µ—Ä–æ–∫** - —Å–Ω–∞—á–∞–ª–∞ `region_map[index] == 0`, –ø–æ—Ç–æ–º `is_white()`
3. **–ò–Ω–¥—É–∫—Ç–∏–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** - –ø—Ä–µ–¥–≤—ã—á–∏—Å–ª–µ–Ω–∏–µ `y_offset = y * width_const`
4. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è** - `Pixel* data = image->data`
5. **–†–µ–¥–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞** - –∫–∞–∂–¥—ã–µ 1000 –ø–∏–∫—Å–µ–ª–µ–π –≤–º–µ—Å—Ç–æ –∫–∞–∂–¥–æ–≥–æ

**–û–∂–∏–¥–∞–µ–º–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ:** ~15-20% –¥–ª—è —ç—Ç–∞–ø–∞ –ø–æ–∏—Å–∫–∞ —Ä–µ–≥–∏–æ–Ω–æ–≤

---

## –¢–µ—Ö–Ω–∏–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

| –¢–µ—Ö–Ω–∏–∫–∞ | –ì–¥–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ | –≠—Ñ—Ñ–µ–∫—Ç |
|---------|---------------|--------|
| **Inline —Ñ—É–Ω–∫—Ü–∏–∏** | `is_white()`, `add_edge_fast()`, `get_degree()`, `is_color_safe()` | –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ overhead –≤—ã–∑–æ–≤–æ–≤ |
| **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª–µ–π** | –î–æ—Å—Ç—É–ø –∫ –º–∞—Ç—Ä–∏—Ü–µ, –¥–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | –°–Ω–∏–∂–µ–Ω–∏–µ –º–æ—â–Ω–æ—Å—Ç–∏ –¥–æ—Å—Ç—É–ø–∞ |
| **–ò–Ω–¥—É–∫—Ç–∏–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** | `y_offset = y * width` | –ò–∑–±–µ–∂–∞–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö —É–º–Ω–æ–∂–µ–Ω–∏–π |
| **–†–∞–∑–≤–µ—Ä—Ç–∫–∞ —Ü–∏–∫–ª–æ–≤** | –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ 4 —ç–ª–µ–º–µ–Ω—Ç–∞ | –£–º–µ–Ω—å—à–µ–Ω–∏–µ overhead —Ü–∏–∫–ª–æ–≤ |
| **–†–∞–Ω–Ω–∏–π –≤—ã—Ö–æ–¥** | –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–≥–∏–æ–Ω–æ–≤ | –ò–∑–±–µ–∂–∞–Ω–∏–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π |
| **–ë–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞** | –ü–æ–∏—Å–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤ | O(1) –≤–º–µ—Å—Ç–æ O(n) |
| **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã** | –†–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è –º–∞–ª—ã—Ö/–±–æ–ª—å—à–∏—Ö –≥—Ä–∞—Ñ–æ–≤ | –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å |
| **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—è–¥–∫–∞** | –ü—Ä–æ–≤–µ—Ä–∫–∞ `region_map` –ø–µ—Ä–µ–¥ `is_white()` | Short-circuit evaluation |
| **–£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫** | –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ —Ü–≤–µ—Ç–æ–≤ | –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π |
| **–†–µ–¥–∫–∏–π –≤—ã–≤–æ–¥** | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ | –£–º–µ–Ω—å—à–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö I/O |

---

## –û–±—â–µ–µ –æ–∂–∏–¥–∞–µ–º–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ

- **–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞:** ~20-30%
- **–†–∞—Å–∫—Ä–∞—Å–∫–∞ –≥—Ä–∞—Ñ–∞:** ~25-35%
- **–ü–æ–∏—Å–∫ —Ä–µ–≥–∏–æ–Ω–æ–≤:** ~15-20%
- **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤:** ~10-15%
- **–û–±—â–µ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã:** ~20-30%

---

## –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ –∏–∑–º–µ–Ω–µ–Ω–æ** - –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –ø—Ä–µ–∂–¥–µ  
‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞** - –≤—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–µ –∏–∑–º–µ–Ω—è—é—Ç –ª–æ–≥–∏–∫—É –∞–ª–≥–æ—Ä–∏—Ç–º–∞  
‚úÖ **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –∫–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è —Å —Ñ–ª–∞–≥–æ–º `-O2`  
‚úÖ **–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å** - –≤—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–µ—Ä–µ–Ω–æ—Å–∏–º—ã –º–µ–∂–¥—É –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏  

---

## –ö–æ–º–ø–∏–ª—è—Ü–∏—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏

```bash
gcc -o map_colorizer_ultra bmp_handler.c colorizer.c graph.c main.c region_detector.c utils.c -lm -O2
```

---

*–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ñ–∞–π–ª–µ `OPTIMIZATIONS.md`*

